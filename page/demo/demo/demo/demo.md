# 前言
  前几天一直在做One_Tree_Skyblock科技空岛，因为许多地方都要用实体帮助定位，所以就想出来了这个装置。
  教程会尽可能讲的详细，随时更新，更新后会在b站动态通知，注意查看。PPT动画也在计划中。
  另外，基岩版的指令系统与Java版差别较大，请勿进行“无脑比较”。

# 思路分享
## 一.为什么要做这个屑东西？
  因为在基岩版原版中，很难（也许不能，没做太多研究）做到所谓的方块之间的互动、增加新的功能性方块或多方块结构，所以就设计出这个就设计出了这个屑玩意。
  有关此设计的运用，我总结出以下3点：
  1.基于原版的功能性方块的自定义互动：例子是“随时随地的容器内自定义合成”，其原理不必多说；加上此装置即可实现“随时随地合成”的效果，即通过``/execute ... testforblocks ...``的方式对容器进行定位并比较。
  2.添加自定义的方块外的互动：例子是“物品传送带”，用此装置可以做到类似各模组中的效果，做到：用自定义合成器合成出对应的刷怪蛋，用刷怪蛋“放置”对应方块，实现对应功能。（有关物品传送带，因为涉及到方向问题，以后会在第九部分详讲）
  3.多方块结构的核心方块：例子是“熔融熔炉”，做到：用自定义合成的方式做出所谓“熔融熔炉核心”，用合成出的刷怪蛋“放置”此核心，再在此核心周围按一定顺序摆放一些方块，最终建立多方块结构。通过``/execute ... testforblock/testforblocks ...``探测以此核心为基准点的相对坐标处是否有指定的方块，以此建立多方块结构。（有关熔融熔炉等不成中心对称、有容积的多方块结构，因为涉及到方向问题和容积问题，以后会在第九部分详讲）
> 以上所举的三个例子，将来都会在One_Tree_Skyblock空岛中体现。
## 二.具体思路
  要完成这个设计，思路主要分为提前准备、放置特殊方块、破坏和移动特殊方块的准备、破坏特殊方块、移动特殊方块、保障措施、特殊方块的效果制作、红石控制特殊方块8大部分，和可选模块。
  **提前准备**：准备装置需要用到的包含特殊实体的刷怪蛋和需要用到的结构。
  **放置特殊方块**：通过``/execute ... fill/clone ...``命令，在检测到指定实体后填充或复制特殊方块到该实体处。
  **保障措施**：通过给予药水效果等方式，防止辅助用的实体（触发实体和定位实体）非计划性的死亡或移动。
  **效果制作**：通过检测指定实体的相对坐标处有无指定的实体或方块，以执行对应的命令。
  **破坏和移动特殊方块的准备**：为破坏和移动特殊方块做一些准备。
  **破坏特殊方块**：指存在特殊方块的位置变为空气。通过检测指定实体处是否为空气，然后依次执行生清除原有掉落物、生成实际掉落物、清除指定实体3步。
  **移动特殊方块**：指通过同一坐标轴上的活塞或通过活塞连接的粘液块或蜂蜜块移动该特殊方块。目前以有较好的方法且正在优化中，如果有人想到了自己的方法，欢迎联系我（们）。
  **红石控制特殊方块**：用红石控制一些工具性方块的开关。目前除穷举外无其他好方法，如果有人想到了其他方法，欢迎联系我（们）。
  **可选模块**：即根据实际情况，主观选择加入的部分，可能是必要的，也可能是非必要的。

------------


# 举例教程
## 目标效果
  用一颗刷怪蛋放置一个方块破坏器（一个石头），它可以破坏它上面一格的泥土。
### 效果分析
  其实要做到这个效果也很简单，
## 注释
  ↓这是操作方式，意思是与上一个命令方块连在一起，或与上一步连在一起。
  →这也是操作方式，意思是自己单独运行或一串命令方块或操作的开头。
  ↘表示即可以自己单独运行，也可以和上一个命令方块连在一起，此种情况下，在图片中演示时将默认为“循环”型。
  /这是命令
  #这是指令翻译或对这样操作后效果的描述。
  !这是注意事项或对命令的解释。
## 特殊词语解释
  **触发实体**：用来触发整个装置的实体，由玩家生成。
  **定位实体**：用来辅助命令方块进行定位，由命令生成。
  **重定位实体**：用来对移动后的特殊方块进行重定位，由命令生成。
## 需要用到的工具
  Android：Blocktopograph（简称Btr）。
  Windows：暂时还不知道有什么应用可以完成此类操作。

## 注意事项
  这只是一个例子，在使用时需按照实际情况修改。
  部分游戏中的“错误翻译”并未订正。
  此教程中，填充方块所用的相对坐标的偏移量，视图片而定：
    向上即为y+，向下即为y-；
    向右即为x+，向左即为x-；
  适配版本：基岩版1.16.100.52+
  介于篇幅原因，本节先讲第一至四部分。

## 第一部分：提前准备
→创造一个世界，记得将“作弊”和“开启实验玩法”选项打开。
↓在背包里放一个僵尸马蛋。
↓将其命名为“``stone``”。
**#这样，生成出的就是一个名叫“stone”的僵尸马了。**
<font color=red>!使用僵尸马是因为它不能自然生成，防止玩家将其巧合地命名为“``stone``”后启动这个装置。</font>
↓在对话栏内输入
````Minecraft
/give @s structure_block
````
**#给予(give)命令执行者(@s)一个结构方块(structure_block)。**
````Minecraft
/give @s structure_void
````
**#给予(give)命令执行者(@s)一个结构空位(structure_void)。**
↓放置一个结构空位，将这个刷怪蛋扔到这个结构空位里，使其成为掉落物实体。
↓将上面的刷怪蛋的掉落物实体连同它所在位置上的结构空位一起保存，结构名为“``stone_egg``”。
**#这样就可以用结构方块生成此掉落物实体了。**
→在对话栏内输入
````Minecraft
/give @s command_block
````
**#给予(give)命令执行者(@s)一个命令方块(command_block)。**
→循环，无条件，始终活动，0
````Minecraft
/tp @e[type=bat,c=1] ~ ~1 ~
````
**#将距离这个命令方块最近(c=1)的蝙蝠(type=bat)传送(tp)到这个命令方块上面1格(~ ~1 ~)处。**
↓在这个命令方块上放置你要做的特殊方块的基础方块，此处为石头。
↓链，无条件，始终活动，0
````Minecraft
/effect @e[type=bat,c=1] regeneration 1 255 true
````
**#赋予距离这个命令方块最近(c=1)的蝙蝠(type=bat)以1秒(1)的256级(255)的生命恢复(regeneration)效果(effect)，且不显示其粒子效果(true)。**
↓放置一个蝙蝠
**#这个蝙蝠会被传送到上文中的命令方块的上方一格处。**
<font color=red>!请确保该蝙蝠距离上文中的命令方块最近。</font>
↓在对话栏内输入
````Minecraft
/tag @e[type=bat,c=1] add stone
````
**#给距离玩家最近(c=1)的蝙蝠(type=bat)添加(add)“``stone``”(stone)标签(tag)。**
<font color=red>!该蝙蝠即是上文中被传送到命令方块上面一格处的蝙蝠，并请确保该蝙蝠离你最近。</font>
↓放置一个结构方块。
↓将上文中的蝙蝠连同它所在位置上的石头一起保存，结构名为“``stone``”。
**#这样就可以用结构方块生成此结构了。**
**#这个结构其实就是所做的特殊方块。**
↓破坏刚刚放置的所有方块。
## 第二部分：放置特殊方块
→循环，无条件，始终活动，0
````Minecraft
/execute @e[type=zombie_horse,name=stone,c=1] ~ ~ ~ detect ~ ~ ~ air 0 structure load stone ~ ~0.2 ~
````
**#检测(execute)到距这个命令方块最近(c=1)的在其所在位置(detect ~ ~ ~)是空气(air)的名称为“``stone``”(name=stone)的僵尸马(type=zombie_horse)，在它的上方0.2格处(~ ~ ~;~ ~0.2 ~)加载(load)“``stone``”(stone)结构(structure)。**
<font color=red>!此处“``c=1``”原指“一个实体”，其默认为选取离目标选择器基准点最近的1个实体，所以用在这里选择距离最近的实体。</font>
<font color=red>!添加“``0.2``”是为了防止僵尸马因重力下落后生成位置的误差。</font>
↓链，有条件，始终活动，0
````Minecraft
/execute @e[type=bat,tag=stone,c=1] ~ ~ ~ execute @e[type=zombie_horse,name=stone,c=1,r=1] ~ ~ ~ detect ~ ~ ~ stone 0 ~ ~ ~ tp @s ~ -10 ~
````
**#检测(execute)到距这个命令方块最近(c=1)的标签为“stone”(tag=stone)的蝙蝠(type=bat)处(~ ~ ~)有在其所在位置(detect ~ ~ ~)是石头(stone 0)的名称为“``stone``”(name=stone)的僵尸马(type=zombie_horse)，将它传送到x、z坐标不变，y坐标为-10(~ -10 ~)的地方。**
<font color=red>!传送到y=-10是为了清除该实体及其所掉落的掉落物。</font>
## 第三部分：保障措施
→循环，无条件，始终活动，0
````Minecraft
/effect @e[type=bat,name=stone] invisibility 5 0 true
````
**#赋予名称为“stone”(name=stone)的所有是蝙蝠的实体(type=bat)以5秒(5)的1级(0)的隐身(invisibility)效果(effect)，且不显示其粒子效果(true)。**
<font color=red>!此处将时间设置为“``5``”是为了在实体死（被清除）后仍不显示其死亡动画。</font>
↘链，无条件，始终活动，0
````Minecraft
/effect @e[type=bat,name=stone] regeneration 1 255 true
````
**#赋予名称为“stone”(name=stone)的所有是蝙蝠的实体(type=bat)以1秒(1)的256的(255)的生命恢复(regeneration)效果(effect)，且不显示其粒子效果(true)。**
!使其可以迅速恢复生命。
↘链，无条件，始终活动，0
````Minecraft
/effect @e[type=bat,name=stone] resistance 1 255 true
````
**#赋予名称为“``stone``”(name=stone)的所有是蝙蝠的实体(type=bat)以1秒(1)的256级(255)的抗性提升(resistance)效果(effect)，且不显示其粒子效果(true)。**
<font color=red>!使其可以几乎免疫伤害。</font>
↘链，无条件，始终活动，0
````Minecraft
/execute @e[type=bat,name=stone] ~ ~ ~ tp @s ~ ~ ~
````
**#检测(execute)到名称为“stone”(name=stone)的蝙蝠(type=bat)，将它(@s)传送(tp)到其自己的位置(~ ~ ~;~ ~ ~)。**
<font color=red>!用来防止蝙蝠自己移动。</font>
## 第四部分：效果制作
→循环，无条件，始终活动，0
````Minecraft
/execute @e[type=bat,name=stone] ~ ~ ~ detect ~ ~1 ~ dirt 0 fill ~ ~1 ~ ~ ~1 ~ air 0 destroy
````
**#检测(execute)到在其上方1格处(detect ~ ~1 ~)为空气(air)的离最近(c=1)的名称为“``stone``”(tag=stone)的蝙蝠(type=bat)，在它上方一格处(~ ~ ~;~ ~1 ~ ~ ~1 ~)填充(fill)空气(air)，并掉落其以非附魔的铲子破坏后的掉落物。**

------------


# FAQ
1.本例子以石头(``stone``)举例，其主要原因的：
    （1）该方块有两种掉落物。
    （2）该方块的不同的特殊值指向不同方块，其中特殊值“``0``”指石头(``stone``)。
2.本例子以蝙蝠作为定位实体的主要原因有：
    （1）碰撞箱较小。
    （2）生成时处于悬浮状态，不易因重力发生位移。
3.本例子以僵尸马作为触发实体的主要原因：
     僵尸马不能自然生成，以防止玩家在实际使用时，因不小心给触发实体命名为相同的名称而触发整个装置。

------------


# 待修bug
暂无

------------


# 鸣谢
1.[泥土NITU](https://space.bilibili.com/382542159)
  感谢其为此设计提供有关触发实体选用的思路。

------------


# 其他一些无关紧要的事
## 招募启示
  Command_block_Skyblock工作室招新，这是一个刚刚建立不久的基岩版国际版工作室，但由于缺乏可以长时间游戏在线的人员，作品进度缓慢。目前在做的（也是唯一的）作品是One_Tree_Skyblock原版科技空岛生存，希望有爱玩命令的玩家加入我们，一起做这张地图。
  One_Tree_Skyblock原版科技空岛生存简介：这是一个仅仅基于原版命令方块的科技类空岛生存，中心主题的是为了让玩家更好的实现资源获取的自动化。正如地图的名称，整个空岛生存的开局中有一棵树和一块泥土，玩家要试图在这样一个空岛是生存下去。当然，我们也想到了一些必要的更改，我们让僵尸掉落铁锭的几率增加，以快速的度过前期的艰难时刻。我们让破坏泥土可以掉落“小石子”；熔融圆石可以获得岩浆以获得一些原本在这个空岛上不能获得，而生存却必须要用的材料。我们做的伪·守卫者和其他一些生物的自然生成，以满足玩家对守卫者农场的需求。到了后期，玩家还可以通过自定义合成，做出所谓“传送带”、“风机”、“熔炼熔炉”、“熔炼熔炉”等有特殊的方块和多方块结构，以完成所谓的自动化。除了这些，还有更多的内容等待被想出并加入（注：上文所述的装置，部分还在计划当中，因人手不足，并未制作）。
  赶快来加入我们吧，和我们一起完成这地图的制作。QQ群号：758449163，入群问题按要求回答即可。
## 合成表征集
  可以是用原版的物品合成，也可以不用原版的（不是原版的材料需要附合成表或来源）。
  待分配合成表的物品：物品传送带、物品传送接口、熔融熔炉核心、浇铸口、熔炼熔炉核心、液体储罐核心、风机、物品电梯、筛子、滤网、黑曜石滤网、液体传送接口、液体管道。
  [点击参与征集](http://commandblockskyblock.infinityfreeapp.com/blog/2020/08/合成表征集/)
